Options +FollowSymLinks
RewriteEngine On
RewriteBase /

# =========================================
# BỎ QUA FILE HOẶC THƯ MỤC THẬT
# =========================================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# =========================================
# TRANG ADMIN
# =========================================
RewriteRule ^quantri$ dirdoaibiet.php [L]

# =========================================
# TRANG CHỦ
# =========================================
RewriteRule ^index\.html$ index.php [L,QSA]
RewriteRule ^$ index.php [L,QSA]

# =========================================
# TIẾNG ANH: /en/...
# =========================================
# Ưu tiên có page + sort trước
RewriteRule ^en/([a-zA-Z0-9\-]+)/page/([0-9]+)/sort/([a-zA-Z0-9\-_]+)/?$ index.php?lang=en&cat1=$1&page=$2&sort=$3 [L,QSA]
RewriteRule ^en/([a-zA-Z0-9\-]+)/sort/([a-zA-Z0-9\-_]+)/?$ index.php?lang=en&cat1=$1&sort=$2 [L,QSA]
RewriteRule ^en/([a-zA-Z0-9\-]+)/page/([0-9]+)/?$ index.php?lang=en&cat1=$1&page=$2 [L,QSA]

# Chi tiết sản phẩm tiếng Anh
RewriteRule ^en/([a-zA-Z0-9\-]+)\.html$ index.php?lang=en&unique_key=$1 [L,QSA]

# Danh mục con tiếng Anh
RewriteRule ^en/([a-zA-Z0-9\-]+)/([a-zA-Z0-9\-]+)/?$ index.php?lang=en&cat1=$1&cat2=$2 [L,QSA]

# Danh mục cha tiếng Anh
RewriteRule ^en/([a-zA-Z0-9\-]+)/?$ index.php?lang=en&cat1=$1 [L,QSA]

# =========================
# TÌM KIẾM — đặt TRƯỚC các rule tiếng Việt
# =========================
RewriteRule ^tim-kiem/([^/]+)/page/([0-9]+)/?$ index.php?do=search&keyword=$1&page=$2 [L,QSA]
RewriteRule ^tim-kiem/([^/]+)/?$ index.php?do=search&keyword=$1 [L,QSA]

# =========================================
# TIẾNG VIỆT: không có /vn/
# =========================================
RewriteRule ^([a-zA-Z0-9\-]+)/page/([0-9]+)/sort/([a-zA-Z0-9\-_]+)/?$ index.php?cat1=$1&page=$2&sort=$3 [L,QSA]
RewriteRule ^([a-zA-Z0-9\-]+)/sort/([a-zA-Z0-9\-_]+)/?$ index.php?cat1=$1&sort=$2 [L,QSA]
RewriteRule ^([a-zA-Z0-9\-]+)/page/([0-9]+)/?$ index.php?cat1=$1&page=$2 [L,QSA]

# Chi tiết sản phẩm tiếng Việt
RewriteRule ^([a-zA-Z0-9\-]+)\.html$ index.php?unique_key=$1 [L,QSA]

# Danh mục con tiếng Việt
RewriteRule ^([a-zA-Z0-9\-]+)/([a-zA-Z0-9\-]+)/?$ index.php?cat1=$1&cat2=$2 [L,QSA]

# Danh mục cha tiếng Việt
RewriteRule ^([a-zA-Z0-9\-]+)/?$ index.php?cat1=$1 [L,QSA]
